# パフォーマンス最適化

## モデル選択戦略

**Haiku 4.5** (Sonnet の 90% の能力、コスト 3 分の 1):
- 頻繁に呼び出される軽量 agent
- ペアプログラミングとコード生成
- マルチ agent システムの worker agent

**Sonnet 4.5** (最高のコーディングモデル):
- メインの開発作業
- マルチ agent ワークフローのオーケストレーション
- 複雑なコーディングタスク

**Opus 4.5** (最も深い推論):
- 複雑なアーキテクチャの意思決定
- 最大限の推論が必要な場合
- リサーチと分析タスク

## Context Window 管理

Context window の残り 20% では以下を避ける:
- 大規模なリファクタリング
- 複数ファイルにまたがる機能実装
- 複雑なインタラクションのデバッグ

Context 使用量が少ないタスク:
- 単一ファイルの編集
- 独立したユーティリティの作成
- ドキュメントの更新
- シンプルなバグ修正

## Ultrathink + Plan Mode

深い推論が必要な複雑なタスクの場合:
1. `ultrathink` を使用して思考を強化する
2. **Plan Mode** を有効にして構造化されたアプローチを取る
3. 複数回の批評ラウンドで「エンジンを回す」
4. 多角的な分析のために役割分担した sub-agent を使用する

## ビルドのトラブルシューティング

ビルドが失敗した場合:
1. **build-error-resolver** agent を使用する
2. エラーメッセージを分析する
3. 段階的に修正する
4. 各修正後に検証する
